<!DOCTYPE html>
<html>
  <head>
  <title>Shawn Blakesley's Example Page (Updates imminent)</title>
  <style>canvas { width: 100%; height: 100%;} </style>
  </head>
  <body bgcolor="#000000">
  <script type="text/javascript" src="https://rawgithub.com/mrdoob/three.js/master/build/three.js"></script>
  <script type="text/javascript" src="https://rawgithub.com/mrdoob/three.js/master/examples/js/controls/OrbitControls.js"></script>
  <script type="text/javascript" src="lib/dat.gui.min.js"></script>
  <script type="text/javascript" src="lib/uclass_TeapotGeometry.js"></script>
  
  <!--Shaders for toon shading based loosly off udacity course lectures for interactive 3d graphics-->
  <script type="x-shader/x-vertex" id="toon_shader_vertex">
  varying vec3 vNormal;
  varying vec3 vViewPosition;
  varying vec3 surfacePos;

  void main() {
    surfacePos = position;

    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
    vNormal = normalize( normalMatrix * normal );
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    vViewPosition = -mvPosition.xyz;
  }
  </script>
  <script type="x-shader/x-fragment" id="toon_shader_fragment">
  uniform vec3 uMaterialColor;

  uniform vec3 uDirLightPos;
  uniform vec3 uDirLightColor;

  uniform float uKd;
  uniform float uBorder;
  uniform float checker_size;

  varying vec3 vNormal;
  varying vec3 vViewPosition;
  varying vec3 surfacePos;

  void main() {
    vec3 position = surfacePos / checker_size;
    vec3 color = uMaterialColor;
    if(fract(position.x) < 0.5 && fract(position.z) < 0.5){
      color *= 2.0;
    }
    else if(fract(position.z) < 0.5){
      color *= 1.5;
      color.rg = vec2(0.0, 0.0);
    }
    else if(fract(position.x) < 0.5)
    {
      color *= 1.0;
    }
    else{
      color *= 0.0;
    }
    // compute direction to light
    vec4 lDirection = viewMatrix * vec4( uDirLightPos, 0.0 );
    vec3 lVector = normalize( lDirection.xyz );

    // diffuse: N * L. Normal must be normalized, since it's interpolated.
    vec3 normal = normalize( vNormal );
    
    float diffuse = dot( normal, lVector );
    //Create a cartoon look with 3 intensities
    diffuse = diffuse > uBorder ? 1.0 : diffuse > uBorder - 0.2 ? 0.4 : 0.1;

    gl_FragColor = vec4( uKd * color * uDirLightColor * diffuse, 1.0 );
  }
  </script>

  <!--Shaders for environment mapping-->
  <script type="x-shader/x-vertex" id="env_shader_vertex">
  void main()
  {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
  }
  </script>
  <script type="x-shader/x-fragment" id="env_shader_fragment">
  void main()
  {
    gl_FragColor = vec4( 1.0, 1.0, 1.0, 1.0 );
  }
  </script>
  <script src="scripts/shaders.js"></script>
  </body>
</html>